<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <!-- Reused CSS Link -->
    <link href="{{ url_for('static', filename='css/main.css') }}" rel="stylesheet">
    <!-- Dashboard CSS Link -->
    <link href="{{ url_for('static', filename='css/dashboard.css') }}" rel="stylesheet">
    <!-- Lottery CSS Link -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap" rel="stylesheet">
    <!-- Bootstrap CSS Link -->
    <link href="https://cdn.bootcss.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS Link for Lottery Modal-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Bootstrap Icon Link-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{{ url_for('static', filename='js/raffle.js') }}"></script>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-md navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand ps-5" href="{{ url_for('index') }}"><img class="logo" alt="nft-logo" src="{{ url_for('static', filename='images/logo.png') }}">Virtual NFT Market</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end pe-5" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="{{ url_for('index') }}"><b>Home</b></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('marketplace') }}"><b>Marketplace</b></a> 
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('leaderboard') }}"><b>Leader Board</b></a>
                    </li>
                      
                </ul>
            </div>
        </div>
    </nav>
     <!-- User info -->
    <div class="user-info">
        <h1 class="mt-5 mb-5">Dashboard</h1>
        <div class="info-head mb-5">
            <div class="d-flex align-items-center justify-content-center flex-column">
                <div class="mb-3">
                    <img src="{{ url_for('static', filename='images/seller8.png') }}" class="user-img d-block">
                </div>
            </div>
            <h3 class="text-center">Hello {{ current_user.username }},welcome to dashboard!</h3>
            <h4 class="text-center">Balance:{{ '%.2f'|format(current_user.balance) }} ETH</h4>
            <!-- Logout Button -->
            <div class="d-flex align-items-center justify-content-center mb-3">
                <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#logoutModal">
                    Logout
                </button>
            </div>
            <!-- Logout Modal -->
            <div class="modal fade col-8" id="logoutModal">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-body">
                            Are you sure you want to logout?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                            <a href="{{ url_for('logout') }}" class="btn btn-danger">Logout</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- echo flash message -->
            <div class="container col-8 text-center">
                {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
                {% endwith %}
            </div>     
        </div>
        <!-- User Nav Section -->
        <div class="container nav-container"> 
            <!-- Nav tabs -->
            <ul class="nav nav-tabs" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" data-bs-toggle="tab" href="#my-trade">My Trade</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#my-fragments">My Fragments</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#my-collection">My Collection</a>
                </li>
            </ul>
            <!-- nav tab content -->
            <div class="tab-content">
                <!-- my trade -->
                <div id="my-trade" class="container tab-pane active"><br>
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Images</th>
                                <th>Name</th>
                                <th>Price</th>
                                <th>Date</th>
                                <th>Seller</th>
                                <th>Operation</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                    <!-- test block need to be delete later -->
                    <div class="container"><br>
                        <h3>for scroll test only,content need to be delete later</h3>
                    <p style="font-size:5rem">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.</p>
                    </div>
                </div>
                <!-- my fragments -->
                <div id="my-fragments" class="container tab-pane fade"><br>
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Images</th>
                                <th>id</th>
                                <th>name</th>
                                <th>Redeem</th>
                                <th>Sale</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for fragment in current_user.user_fragments %}
                            <tr><td><img class="trade-img" src="{{ url_for('static', filename=fragment.path.split('static/')[-1])}}"></td>
                                <td>{{ fragment.id }}</td>
                                <td>{{ fragment.path.split('static/outputs/')[-1] }}</td>
                                <td><button type="button" class="btn btn-danger">Redeem</button></td>
                                <td><button type="button" class="btn btn-danger">Sale</button></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <!-- test block need to be delete later -->
                    <!-- my fragments -->
                    <div class="container"><br>
                        <h3>TEST ONLY</h3>
                        <div class="row mt-5 mb-5">
                            <div class="col-sm-3">
                                <div class="card">
                                    <img src="{{ url_for('static', filename='images/fox.jpg') }}" class="card-img-top" alt="cat nft">
                                    <div class="card-body d-flex justify-content-between">
                                        <span>
                                            <small>Seller</small><br>
                                            <p>Emma R.</p>
                                        </span>
                                        <span>
                                            <small>Price</small><br>
                                            <p>9.2 ETH</p>
                                        </span>
                                        <span>
                                            <button type="button" class="btn btn-danger">Sale</button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card">
                                    <img src="{{ url_for('static', filename='images/tiger.jpg') }}" class="card-img-top" alt="tiger nft">
                                    <div class="card-body d-flex justify-content-between">
                                        <span>
                                            <small>Seller</small><br>
                                            <p>Emma R.</p>
                                        </span>
                                        <span>
                                            <small>Price</small><br>
                                            <p>9.2 ETH</p>
                                        </span>
                                        <span>
                                            <button type="button" class="btn btn-danger">Sale</button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card">
                                    <img src="{{ url_for('static', filename='images/octopus.jpg') }}" class="card-img-top" alt="panda nft">
                                    <div class="card-body d-flex justify-content-between">
                                        <span>
                                            <small>Seller</small><br>
                                            <p>Emma R.</p>
                                        </span>
                                        <span>
                                            <small>Price</small><br>
                                            <p>9.2 ETH</p>
                                        </span>
                                        <span>
                                            <button type="button" class="btn btn-danger">Sale</button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card">
                                    <img src="{{ url_for('static', filename='images/monky.jpg') }}" class="card-img-top" alt="monky nft">
                                    <div class="card-body d-flex justify-content-between">
                                        <span>
                                            <small>Seller</small><br>
                                            <p>Noah T.</p>
                                        </span>
                                        <span>
                                            <small>Price</small><br>
                                            <p>13.2 ETH</p>
                                        </span>
                                        <span>
                                            <button type="button" class="btn btn-danger">Sale</button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

            </div>
            <!-- my collection -->
            <div id="my-collection" class="container tab-pane fade"><br>
                <!-- test block need to be delete later -->
                <div class="container"><br>
                    <h3>for scroll test only,content need to be delete later</h3>
                <p style="font-size:5rem">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.</p>
                </div>
                <!-- my collection -->
            <div class="container"><br>
                <h3>My Collection</h3>
                <div class="row mt-5 mb-5">
                    <div class="col-sm-3">
                        <div class="card">
                            <img src="{{ url_for('static', filename='images/cat.jpg') }}" class="card-img-top" alt="cat nft">
                            <div class="card-body d-flex justify-content-between">
                                <span>
                                    <small>Seller</small><br>
                                    <p>Emma R.</p>
                                </span>
                                <span>
                                    <small>Price</small><br>
                                    <p>9.2 ETH</p>
                                </span>
                                <span>
                                    <button type="button" class="btn btn-secondary">Unlike</button>
                                    <button type="button" class="btn btn-danger">Buy</button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card">
                            <img src="{{ url_for('static', filename='images/tiger.jpg') }}" class="card-img-top" alt="tiger nft">
                            <div class="card-body d-flex justify-content-between">
                                <span>
                                    <small>Seller</small><br>
                                    <p>Liam S.</p>
                                </span>
                                <span>
                                    <small>Price</small><br>
                                    <p>18.6 ETH</p>
                                </span>
                                <span>
                                    <button type="button" class="btn btn-secondary">Unlike</button>
                                    <button type="button" class="btn btn-danger">Buy</button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card">
                            <img src="{{ url_for('static', filename='images/frog.jpg') }}" class="card-img-top" alt="panda nft">
                            <div class="card-body d-flex justify-content-between">
                                <span>
                                    <small>Seller</small><br>
                                    <p>Noah T.</p>
                                </span>
                                <span>
                                    <small>Price</small><br>
                                    <p>8.5 ETH</p>
                                </span>
                                <span>
                                    <button type="button" class="btn btn-secondary">Unlike</button>
                                    <button type="button" class="btn btn-danger">Buy</button>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card">
                            <img src="{{ url_for('static', filename='images/monky.jpg') }}" class="card-img-top" alt="monky nft">
                            <div class="card-body d-flex justify-content-between">
                                <span>
                                    <small>Seller</small><br>
                                    <p>Noah T.</p>
                                </span>
                                <span>
                                    <small>Price</small><br>
                                    <p>13.2 ETH</p>
                                </span>
                                <span>
                                    <button type="button" class="btn btn-secondary">Unlike</button>
                                    <button type="button" class="btn btn-danger">Buy</button>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div> 
        </div>
    </div>
    </div>

    <!-- Lottery -->
    <div class="container lottery-block">
        <div class="row">
            <div class="col-sm-6 d-flex align-items-start justify-content-center lottery-text">
                <div class="lottery-title-container">
                    <h2 class="lottery-title mb-10">
                        <span>L</span>
                        <span>O</span>
                        <span>T</span>
                        <span>T</span>
                        <span>E</span>
                        <span>R</span>
                        <span>Y</span>
                    </h2>
                    <p class="lottery-intro">Want to collect some rare fragments?<br>
                    Spend 10 ETH each time to participate in our lottery!<br> 
                    Collect a complete set of fragments to redeem rewards! <br>
                    Click on the image on the right to join the lottery now!</p>
                </div>
            </div>
            <!-- Spin Wheel -->
            <div class="lottery-container col-sm-6">
                <div class="spin-wheel">
                    <div class="one">1</div>
                    <div class="two">2</div>
                    <div class="three">3</div>
                    <div class="four">4</div>
                    <div class="five">5</div>
                    <div class="six">6</div>
                </div>
                <span class="wheel-center"></span>
                <button type="button" id="spin" class="btn btn-primary">Spin</button>
                <div class="stopper"></div>
            </div>

            
            <!-- please move modal function to spin button later -->
            <button type="button" id="raffleButton" class="btn btn-primary mt-5">Try Your Luck!</button>
            <!-- Modal box -->
            <div class="modal" id="raffleModal">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <!-- Head -->
                        <div class="modal-header">
                            <h4 class="modal-title">Congratulations!</h4>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <!-- Content -->
                        <div class="modal-body">
                            <!-- Dynamically insert the image and split name -->
                            <p>You've won a piece!</p>
                            <img id="winningSplitImage" src="" alt="Winning Split" class="img-fluid"> 
                            <p id="winningSplitName"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
    
        
    </div> 
        <!-- Footer -->
        <footer class="bg-light text-center text-lg-start">
            <div class="container p-4">
                <div class="row align-items-center">
                    <div class="col-lg-6 col-md-12 mb-4 mb-md-0">
                        <h5 class="text-uppercase">Balance</h5>
                        <p>
                            Balance offers a platform to trade and collect virtual NFTs. We are dedicated to providing a secure and engaging environment for our users.
                        </p>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                        <h5 class="text-uppercase">Links</h5>
                        <ul class="list-unstyled mb-0">
                            <li>
                                <a href="{{ url_for('about') }}" class="text-dark">About Us</a>
                            </li>
                            <li>
                                <a href="{{ url_for('terms') }}" class="text-dark">Terms of Service</a>
                            </li>
                            <li>
                                <a href="{{ url_for('privacy') }}" class="text-dark">Privacy Policy</a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                        <h5 class="text-uppercase">Follow Us</h5>
                        <ul class="list-unstyled">
                            <li>
                                <a href="#!" class="text-dark">Twitter</a>
                            </li>
                            <li>
                                <a href="#!" class="text-dark">Facebook</a>
                            </li>
                            <li>
                                <a href="#!" class="text-dark">Instagram</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="text-center p-3" style="background-color: #f0f0f0;">
                © 2024 Balance, Inc. All rights reserved.
            </div>
        </footer>
    <!-- Lottery Spin Wheel JS Link-->
    <script src="{{ url_for('static', filename='js/spin.js') }}"></script>
</body>
</html>
