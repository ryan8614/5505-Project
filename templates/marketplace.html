<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual NFT Marketplace - Marketplace</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.bootcss.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <!-- Reused CSS Link -->
    <link href="{{ url_for('static', filename='css/main.css') }}" rel="stylesheet">
    <!-- Marketplace CSS Link -->
    <link href="{{ url_for('static', filename='css/marketplace.css') }}" rel="stylesheet">
    <!-- Dropdown navbar CSS Link -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-md navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand ps-5" href="{{ url_for('index') }}"><img class="logo" alt="nft-logo" src="{{ url_for('static', filename='images/logo.png') }}">Virtual NFT Market</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end pe-5" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('index') }}"><b>Home</b></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('marketplace') }}"><b>Marketplace</b></a>
                    </li>
                    {% if current_user.is_authenticated %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('dashboard') }}"><b>Dashboard</b></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}"><b>Logout</b></a>
                    </li>
                    {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('login') }}"><b>Log In</b></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('register') }}"><b>Sign Up</b></a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- Marketplace title -->
    <h1 class="mt-5 mb-5 text-center market-title">Marketplace</h1>


    <!-- echo flash message -->
    <div class="container col-8 text-center">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
            <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
        {% endwith %}
    </div> 
    
    <!-- Live Auction Carousel -->
    <div class="container mt-5 mb-5 live-auction">
        <h2 class="mt-5 mb-5 text-center"><b>Live Auctions</b></h2>
        <div id="liveAuctionCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <div class="row bg-white">
                        <div class="col-sm-3">
                            <div class="card">
                                <img src="{{ url_for('static', filename='images/cat.jpg') }}" class="card-img-top" alt="cat nft">
                                <div class="card-body d-flex justify-content-between">
                                    <span>
                                        <small>Creator</small><br>
                                        <p>Emma R.</p>
                                    </span>
                                    <span>
                                        <small>Current Bid</small><br>
                                        <p>9.2 ETH</p>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <img src="{{ url_for('static', filename='images/tiger.jpg') }}" class="card-img-top" alt="tiger nft">
                                <div class="card-body d-flex justify-content-between">
                                    <span>
                                        <small>Creator</small><br>
                                        <p>Liam S.</p>
                                    </span>
                                    <span>
                                        <small>Current Bid</small><br>
                                        <p>18.6 ETH</p>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <img src="{{ url_for('static', filename='images/panda.jpg') }}" class="card-img-top" alt="panda nft">
                                <div class="card-body d-flex justify-content-between">
                                    <span>
                                        <small>Creator</small><br>
                                        <p>Noah T.</p>
                                    </span>
                                    <span>
                                        <small>Current Bid</small><br>
                                        <p>8.5 ETH</p>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <img src="{{ url_for('static', filename='images/monky.jpg') }}" class="card-img-top" alt="monky nft">
                                <div class="card-body d-flex justify-content-between">
                                    <span>
                                        <small>Creator</small><br>
                                        <p>Noah T.</p>
                                    </span>
                                    <span>
                                        <small>Current Bid</small><br>
                                        <p>13.2 ETH</p>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="carousel-item">
                    <div class="row bg-white">
                        <div class="col-md-3">
                            <div class="card">
                                <img src="{{ url_for('static', filename='images/fox.jpg') }}" class="card-img-top" alt="fox nft">
                                <div class="card-body d-flex justify-content-between">
                                    <span>
                                        <small>Creator</small><br>
                                        <p>Olivia W.</p>
                                    </span>
                                    <span>
                                        <small>Current Bid</small><br>
                                        <p>21.6 ETH</p>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <img src="{{ url_for('static', filename='images/octopus.jpg') }}" class="card-img-top" alt="nft">
                                <div class="card-body d-flex justify-content-between">
                                    <span>
                                        <small>Creator</small><br>
                                        <p>Ryan Z.</p>
                                    </span>
                                    <span>
                                        <small>Current Bid</small><br>
                                        <p>53.2 ETH</p>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <img src="{{ url_for('static', filename='images/owl.jpg') }}" class="card-img-top" alt="owl nft">
                                <div class="card-body d-flex justify-content-between">
                                    <span>
                                        <small>Creator</small><br>
                                        <p>David L.</p>
                                    </span>
                                    <span>
                                        <small>Current Bid</small><br>
                                        <p>24.2 ETH</p>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <img src="{{ url_for('static', filename='images/frog.jpg') }}" class="card-img-top" alt="frog nft">
                                <div class="card-body d-flex justify-content-between">
                                    <span>
                                        <small>Creator</small><br>
                                        <p>Eva D.</p>
                                    </span>
                                    <span>
                                        <small>Current Bid</small><br>
                                        <p>7.8 ETH</p>
                                    </span>
                                </div>
                            </div>
                        </div>    
                    </div>
                </div>
            </div>
            <!-- Carousel controls -->
            <button class="carousel-control-prev" type="button" data-bs-target="#liveAuctionCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#liveAuctionCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>

    <!-- Available Fragments -->
    <h1 class="mb-3 text-center">Fragments On Sale</h1>
    <div class="sidebar-container">
        <!-- All Fregments Section  -->
        <div class="section">
            <div class="section-content" id="all-fragments">
                <div class="row row-cols-1 row-cols-md-6 g-4">
                    <!-- Grab Tradable fragments from the database -->
                    {% for trade in trades %}
                    <div class="col">
                        <div class="card h-100">
                            <img src="{{ trade.fragment.path }}" class="card-img-top" alt="{{ trade.fragment.name }}">
                            <div class="card-body">
                                <h5 class="card-title">{{ trade.fragment.name }}</h5>
                                <p class="card-text">Price: {{ trade.price }} ETH</p>
                                <p class="card-text">Release Time: {{ trade.listed_time.date() }}</p>
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#BuyModal"
                                data-fragment-id="{{ trade.fragment.id }}"
                                data-fragment-path="{{ trade.fragment.path }}"
                                data-fragment-name="{{ trade.fragment.name }}"
                                data-fragment-price="{{ trade.price }}"
                                data-fragment-release-time="{{ trade.listed_time.date() }}">
                                    Buy
                                </button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}

                    <!-- Modal Box -->
                    <div class="modal fade" id="BuyModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">

                                <!-- Content -->
                                <div class="modal-body">
                                    <div class="container-fluid text-center">
                                        <img src="" alt="trade-img" class="img-fluid">
                                    </div>
                                    
                                    <h5></h5>
                                    <p class="price"></p>
                                    <p class="release-time"></p>
                                    <p class="balance">
                                        <span>Balance: </span>
                                    {% if current_user.is_authenticated %}
                                        {{ current_user.get_balance() }}<span> ETH</span>
                                    {% else %}
                                        <span>Login to see balance</span>
                                    {% endif %}
                                    </p>
                                </div>
                        
                                <!-- Bottom -->
                                <div class="modal-footer">
                                    <button type="button" id="confirmButton" class="btn btn-primary" data-bs-dismiss="modal"
                                    data-fragment_id="" 
                                    data-buyer="{{ current_user.id }}">
                                        Confirm
                                    </button>
                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                                </div>
                        
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Form -->
    <form id="buyForm" method="POST" action="{{ url_for('buy') }}">
        {{ form.hidden_tag() }}
        <input type="hidden" name="fragment_id" id="hiddenFragmentId">
        <input type="hidden" name="buyer" id="hiddenBuyer">
    </form>

    
     <!-- FAQ -->
    <div class="collap-container">
        <h2 class="FAQ">Frequently Asked Questions</h2>
        <button type="button" class="collap-btn">What Exactly is an NFT?</button>
        <div class="collap-content">
        <p>Non-fungible Tokens are digital valuables that can be purchased and sold utilizing Blockchain technology on an online marketplace. It’s not interchangeable because it’s non-fungible. With the recent advent of Blockchain across many industries, artists and investors have begun to look for methods to use it to transform the way paintings and other valuables are purchased and traded. NFT users can claim ownership of digital property in exchange for cryptocurrency, rather than visiting a physical store or gallery or even bidding at an auction on tangible items. In terms of data, NFTs can be anything. Images, videos, audio, text, and other forms of creative media are all acceptable. Each NFT is unique, with proven ownership, because it is stored on the blockchain.</p>
        </div>
        <button type="button" class="collap-btn">How to Collect NFT Fragments?</button>
        <div class="collap-content">
        <p>You can consume 10 ETH each time to attend lottery on dashboard or buy fragments from marketplace.</p>
        </div>
        <button type="button" class="collap-btn">How to Redeem a Collection?</button>
        <div class="collap-content">
        <p>Once you collect a set of 9 fragments,you can redeem them on dashboard,choose the collection and click redeem.The redeem value will add into your account balance directly</p>
        </div>

        

    </div>
    
    <!-- Footer -->
    <footer class="bg-light text-center text-lg-start">
        <div class="container p-4">
            <div class="row align-items-center">
                <div class="col-lg-6 col-md-12 mb-4 mb-md-0">
                    <h5 class="text-uppercase">Balance</h5>
                    <p>
                        Balance offers a platform to trade and collect virtual NFTs. We are dedicated to providing a secure and engaging environment for our users.
                    </p>
                </div>
                <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                    <h5 class="text-uppercase">Links</h5>
                    <ul class="list-unstyled mb-0">
                        <li>
                            <a href="{{ url_for('about') }}" class="text-dark">About Us</a>
                        </li>
                        <li>
                            <a href="{{ url_for('terms') }}" class="text-dark">Terms of Service</a>
                        </li>
                        <li>
                            <a href="{{ url_for('privacy') }}" class="text-dark">Privacy Policy</a>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                    <h5 class="text-uppercase">Follow Us</h5>
                    <ul class="list-unstyled">
                        <li>
                            <a href="#!" class="text-dark">Twitter</a>
                        </li>
                        <li>
                            <a href="#!" class="text-dark">Facebook</a>
                        </li>
                        <li>
                            <a href="#!" class="text-dark">Instagram</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="text-center p-3" style="background-color: #f0f0f0;">
            © 2024 Balance, Inc. All rights reserved.
        </div>
    </footer>

    <!-- jQuery, Popper.js, and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/marketplace.js') }}"></script>
</body>
</html>
